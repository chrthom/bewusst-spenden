language: node_js

node_js:
  - 8.15.1

env:
  global:
    - APP_NAME_PROD=bewusstspenden
    - APP_NAME_TEST=bewusstspenden-test

build:
  ci:
    - npm install -g ionic
    - npm install
    - if [ "$BRANCH" == "master" ] || [ "$BRANCH" == "prod" ]; then ionic build; else ionic build; fi
  on_success:
    - if [ "$BRANCH" == "master" ] || [ "$BRANCH" == "prod" ]; then rm www/.gitignore; fi
    - if [ "$BRANCH" == "master" ] || [ "$BRANCH" == "prod" ]; then git add www; fi
    - if [ "$BRANCH" == "master" ] || [ "$BRANCH" == "prod" ]; then git commit -m "deployment build"; fi
    - if [ "$BRANCH" == "master" ]; then git push -f git@heroku.com:$APP_NAME_TEST.git master; fi
    - if [ "$BRANCH" == "prod" ]; then git push -f git@heroku.com:$APP_NAME_PROD.git prod:master; fi
